<h1>Courses</h1>

<style>
  .extra {
    display: none;
  }
  
  .expander {
    text-align: center; 
    width:1em;
  }
  
 td {
    border: 1px #36F solid;
    padding: .1em;
  }
</style>

<script type="text/javascript">
  function toggle(id) 
  {
    var shown = $("tr#" + id + "extra").toggle().css("display");
    if(shown == "none")
      return "+";
    else
      return "--";
  }
</script>

<% if @courses.nil? %>
  <% form_tag '/courses', :method => :get do -%>
    <%= text_field_tag 'search' %> <%= submit_tag 'Submit', :name => nil %>
    <div>Instructions: use the search box</div>
  <% end -%>
<% else %>
  Searching for: <%= (params[:search].empty? ? 'All courses' : h(params[:search]) ) %><p/>

  <table width=100%>
  <% for course in @courses %>
    <tr id="<%=course.id%>main" class="main">
      <td class="expander"><a href="javascript:void(0)" onclick="this.innerHTML = toggle('<%=course.id%>')">+</a></td>
      <td><%= course.subject%><%=course.number%></td>
      <td><%=course.name%></td>
    </tr>
    <tr id="<%=course.id%>extra" class="extra">
      <td colspan=3>
      
      <%=course.description%>
      
      <%
        sections = Section.all(:conditions => ['course_id == ?', course.id])
      %>
      <table>
        <% for section in sections %>
          <tr>
            <td><%=section.professor%></td>
            <td><%=section.room%></td>
          </tr>
        <% end %>
      <table>
      
      </td>
    </tr>
  <% end -%>
  </table>
  <br/>
  Courses for: <%= Semester.find(session[:semester]).name %> <br/>

<% end %>
